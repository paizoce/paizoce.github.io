<form id="bookingForm" class="membership-form">
  <div class="form-row">
    <div class="form-group">
      <label for="bf-name">Name</label>
      <input
        id="bf-name"
        name="name"
        type="text"
        placeholder="Your full name"
        required
      />
    </div>
    <div class="form-group">
      <label for="bf-email">Email</label>
      <input
        id="bf-email"
        name="email"
        type="email"
        placeholder="you@example.com"
        required
      />
    </div>
  </div>
  <div class="form-row">
    <div class="form-group">
      <label for="bf-date">Event Date</label>
      <input id="bf-date" name="date" type="date" required />
    </div>
    <div class="form-group">
      <label for="bf-location">Location</label>
      <input
        id="bf-location"
        name="location"
        type="text"
        placeholder="Venue or address"
      />
    </div>
  </div>
  <div class="form-group full-width">
    <label for="bf-message">Message / Details</label>
    <textarea
      id="bf-message"
      name="message"
      placeholder="Tell us about the event and what you'd like Paizo to provide"
    ></textarea>
  </div>
  <div class="actions">
    <button type="submit" class="submit">Send Booking Email</button>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const form = document.getElementById("bookingForm") as HTMLFormElement;
      if (!form) return;

      function encode(text: string | null | undefined): string {
        return encodeURIComponent(text || "");
      }

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const name = (
          document.getElementById("bf-name") as HTMLInputElement
        )?.value?.trim();
        const email = (
          document.getElementById("bf-email") as HTMLInputElement
        )?.value?.trim();
        const date = (document.getElementById("bf-date") as HTMLInputElement)
          ?.value;
        const location = (
          document.getElementById("bf-location") as HTMLInputElement
        )?.value?.trim();
        const message = (
          document.getElementById("bf-message") as HTMLTextAreaElement
        )?.value?.trim();

        // Basic validation
        if (!name || !email || !date) {
          alert("Please fill out your name, email, and event date.");
          return;
        }

        const to = "paizochamberensemble@gmail.com";
        const subject = encode(`Booking request: ${name} - ${date}`);

        let body = "";
        body += `Name: ${name}%0D%0A`;
        body += `Email: ${email}%0D%0A`;
        body += `Event Date: ${date}%0D%0A`;
        if (location) body += `Location: ${location}%0D%0A`;
        body += `%0D%0A`;
        body += `Message:%0D%0A${encode(message)}%0D%0A`;

        const mailto = `mailto:${to}?subject=${subject}&body=${body}`;

        // Open user's default mail client with composed message
        window.location.href = mailto;
      });
    });
  </script>
</form>
